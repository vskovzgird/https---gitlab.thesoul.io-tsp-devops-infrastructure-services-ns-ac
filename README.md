# Description
Проект для создания и управления Kubernetes namespace для команд разработчиков через Terraform

Для каждой команды отдельынй пайпЮ описанный в отдельном файле \
Для каждой команды одна директория (модуль в терминологии Terraform), в котором будут описаны все её неймспейсы \
Модуль версионируются.

Модуль `team` импортирует модуль `clusters` чтобы оперировать набором провайдеров для подключения к кластерам.
Модуль `team` используется для создания реальных namespace команд.

# Структура
`modules` - папка с модулями
`.gitlab` - папка с ci файлами для gitlab-ci.yaml
Остальные папки в корне это команды и их namesapces.
Например, `devops` - команда devops, внутри одноименной папки описана инициализация всех namespaces команды на всех кластерах компании.

# TODO
- Как будет работать с существующими namespace? 
  выдаст ошибку Error: namespaces "test-2" already exists, остальное создаст
  НУЖНО ИМПОРТИРОВАТЬ В СТЕЙТ СУЩЕСТВУЮЩИЕ НЕЙМСПЕЙСЫ
  https://www.terraform.io/cli/commands/import
  Создать namespace на пустом кластере и натравить терраформ со своим списком namespace, в котором нет тех, что есть на кластере.

- Список кластеров - провайдеров терраформ с алиасами должен быть отдельнйо либой с версионированием
- Сам модуль team так же должен быть версионирован, 
- Сохранить модули в terrafrom GitLab registry
- Проработать вопрос зависимости версий модулей от конфигураций команд
- Аплоад в GitLab Terraform registry
- Использование GitLab Terraform state

# Публиц=кация модулей
https://docs.gitlab.com/ee/user/packages/terraform_module_registry/